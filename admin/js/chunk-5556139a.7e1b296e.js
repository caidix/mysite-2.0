(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5556139a"],{"6bb4":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edit-container"},[a("h1",{staticStyle:{"margin-bottom":"0"}},[e._v(e._s(e.id?"编辑文章":"新建文章"))]),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],ref:"postForm",attrs:{model:e.postForm,rules:e.rules}},[a("el-form-item",{staticStyle:{"margin-bottom":"20px"},attrs:{prop:"title"}},[a("MDinput",{attrs:{maxlength:100,name:"name"},model:{value:e.postForm.title,callback:function(t){e.$set(e.postForm,"title",t)},expression:"postForm.title"}},[e._v("标题")])],1),a("div",{staticClass:"postInfo-container"},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"120px",prop:"author",label:"作者:"}},[a("el-input",{attrs:{filterable:"","default-first-option":"",remote:"",placeholder:"请输入作者名"},model:{value:e.postForm.author,callback:function(t){e.$set(e.postForm,"author",t)},expression:"postForm.author"}},e._l(e.userListOptions,(function(e,t){return a("el-option",{key:e+t,attrs:{label:e,value:e}})})),1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"120px",label:"发布时间:"}},[a("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"Select date and time"},model:{value:e.displayTime,callback:function(t){e.displayTime=t},expression:"displayTime"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"120px",prop:"keyword",label:"关键字:"}},[a("el-input",{attrs:{placeholder:"请输入关键字"},model:{value:e.postForm.keyword,callback:function(t){e.$set(e.postForm,"keyword",t)},expression:"postForm.keyword"}})],1)],1)],1)],1),a("div",[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"120px",prop:"category",label:"文章分类"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择文章分类"},model:{value:e.postForm.category,callback:function(t){e.$set(e.postForm,"category",t)},expression:"postForm.category"}},[e._l(e.categoryList,(function(e,t){return[a("el-option",{key:t,attrs:{label:e.name,value:e._id}})]}))],2)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"120px",prop:"origin",label:"文章来源"}},[a("el-select",{attrs:{placeholder:"请选择文章来源"},model:{value:e.postForm.origin,callback:function(t){e.$set(e.postForm,"origin",t)},expression:"postForm.origin"}},[a("el-option",{attrs:{label:"原创",value:0}}),a("el-option",{attrs:{label:"转载",value:1}}),a("el-option",{attrs:{label:"混合",value:2}})],1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"120px",prop:"draft",label:"是否发布"}},[a("el-select",{attrs:{placeholder:"是否发布"},model:{value:e.postForm.draft,callback:function(t){e.$set(e.postForm,"draft",t)},expression:"postForm.draft"}},[a("el-option",{attrs:{label:"草稿",value:1}}),a("el-option",{attrs:{label:"正文",value:0}})],1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"120px",prop:"tags",label:"标签"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择标签分类"},model:{value:e.postForm.tags,callback:function(t){e.$set(e.postForm,"tags",t)},expression:"postForm.tags"}},[e._l(e.tagList,(function(e,t){return[a("el-option",{key:t,attrs:{label:e.name,value:e._id}})]}))],2)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":"120px",prop:"gather",label:"归档"}},[a("el-select",{attrs:{placeholder:"请选择归档分类"},model:{value:e.postForm.gather,callback:function(t){e.$set(e.postForm,"gather",t)},expression:"postForm.gather"}},[e._l(e.gatherList,(function(e,t){return[a("el-option",{key:t,attrs:{label:e.name,value:e._id}})]}))],2)],1)],1),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{"label-width":"120px",prop:"img_url",label:"文章封面"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://localhost:3004/api/admin/upload","on-success":e.upload}},[e.postForm.img_url?a("img",{staticClass:"avatar",attrs:{src:e.postForm.img_url}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)],1),a("el-form-item",{attrs:{"label-width":"120px",label:"简述",prop:"introduction"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.postForm.introduction,callback:function(t){e.$set(e.postForm,"introduction",t)},expression:"postForm.introduction"}})],1)],1)],1)],1),a("el-col",{attrs:{span:24}},[a("Markdown",{attrs:{currentContent:e.content},on:{"submit-article":e.submit}})],1)],1)],1)},n=[],o=(a("96cf"),a("1da1")),l=a("ade3"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"material-input__component",class:e.computedClasses},[a("div",{class:{iconClass:e.icon}},[e.icon?a("i",{staticClass:"el-input__icon material-input__icon",class:["el-icon-"+e.icon]}):e._e(),"email"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"email"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),"url"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"url"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),"number"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,step:e.step,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,max:e.max,min:e.min,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"number"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),"password"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,max:e.max,min:e.min,required:e.required,type:"password"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),"tel"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,required:e.required,type:"tel"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),"text"===e.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:e.name,placeholder:e.fillPlaceHolder,readonly:e.readonly,disabled:e.disabled,autocomplete:e.autoComplete,minlength:e.minlength,maxlength:e.maxlength,required:e.required,type:"text"},domProps:{value:e.currentValue},on:{focus:e.handleMdFocus,blur:e.handleMdBlur,input:[function(t){t.target.composing||(e.currentValue=t.target.value)},e.handleModelInput]}}):e._e(),a("span",{staticClass:"material-input-bar"}),a("label",{staticClass:"material-label"},[e._t("default")],2)])])},s=[],u=(a("a9e3"),{name:"MdInput",props:{icon:String,name:String,type:{type:String,default:"text"},value:[String,Number],placeholder:String,readonly:Boolean,disabled:Boolean,min:String,max:String,step:String,minlength:Number,maxlength:Number,required:{type:Boolean,default:!0},autoComplete:{type:String,default:"off"},validateEvent:{type:Boolean,default:!0}},data:function(){return{currentValue:this.value,focus:!1,fillPlaceHolder:null}},computed:{computedClasses:function(){return{"material--active":this.focus,"material--disabled":this.disabled,"material--raised":Boolean(this.focus||this.currentValue)}}},watch:{value:function(e){this.currentValue=e}},methods:{handleModelInput:function(e){var t=e.target.value;this.$emit("input",t),"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.change",[t]),this.$emit("change",t)},handleMdFocus:function(e){this.focus=!0,this.$emit("focus",e),this.placeholder&&""!==this.placeholder&&(this.fillPlaceHolder=this.placeholder)},handleMdBlur:function(e){this.focus=!1,this.$emit("blur",e),this.fillPlaceHolder=null,"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.blur",[this.currentValue])}}}),c=u,d=(a("ad53"),a("2877")),m=Object(d["a"])(c,i,s,!1,null,"d9b004ee",null),p=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("mavon-editor",{ref:"md",staticStyle:{"min-height":"600px"},on:{change:e.change,imgAdd:e.upadateImg,navigationToggle:e.toggle},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),a("el-button",{attrs:{type:"success"},on:{click:e.submit}},[e._v("提交")])],1)},g=[],f=a("b2d8"),v=(a("64e1"),a("a1fc")),b={components:{mavonEditor:f["mavonEditor"]},props:["currentContent"],watch:{currentContent:function(e){this.content=e}},data:function(){return{content:"",html:""}},methods:{toggle:function(e,t){console.log(e,t)},change:function(e,t){this.html=t},upadateImg:function(e,t){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,o,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=new FormData,n.append("file",t),r.next=4,v["a"].uploadImg(n);case 4:o=r.sent,l=o.data,0===l.code&&a.$refs.md.$img2Url(e,l.data.url);case 7:case"end":return r.stop()}}),r)})))()},submit:function(){this.$emit("submit-article",{content:this.content,html:this.html})}},mounted:function(){}},y=b,x=Object(d["a"])(y,h,g,!1,null,null,null),w=x.exports,F=a("8bc5"),k=a("aece"),C=a("f66f"),_={components:{MDinput:p,Markdown:w},props:{id:{}},computed:{displayTime:{get:function(){return+new Date(this.postForm.createdAt)},set:function(e){this.postForm.createdAt=new Date(e)}}},data:function(){var e,t=this,a=function(e,a,r){a?r():(t.$message({message:e.field+"为必传项",type:"error",duration:2e3}),r(new Error(e.field+"为必传项")))};return{postForm:(e={createdAt:new Date,keyword:"",author:"",title:"",category:[],origin:0},Object(l["a"])(e,"author",""),Object(l["a"])(e,"introduction",""),Object(l["a"])(e,"draft",0),Object(l["a"])(e,"tags",0),Object(l["a"])(e,"img_url",""),Object(l["a"])(e,"gather",""),e),loading:!1,userListOptions:[],rules:{title:[{validator:a}],keyword:[{validator:a}],content:[{validator:a}]},content:"",categoryList:[],tagList:[],gatherList:[]}},created:function(){this.getCategory(),this.getTag(),this.getGather(),this.id&&this.fetch()},methods:{upload:function(e){this.$set(this.postForm,"img_url",e.url)},fetch:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,v["a"].findOneArticle({id:e.id});case 3:a=t.sent,r=a.data,0===r.code&&(e.$message({message:r.message,type:"success",duration:2e3}),r=r.data,e.postForm={title:r.title,category:r.category,origin:r.origin,author:r.author,introduction:r.introduction,draft:r.draft,keyword:r.keyword,createdAt:r.createdAt,tags:r.tags,img_url:r.img_url},e.content=r.articleContent.content),e.loading=!1;case 7:case"end":return t.stop()}}),t)})))()},getCategory:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,F["a"].getCategories({all:!0});case 2:a=t.sent,r=a.data,0===r.code&&(e.categoryList=r.data.data);case 5:case"end":return t.stop()}}),t)})))()},getGather:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,C["a"].getGather({all:!0});case 2:a=t.sent,r=a.data,0===r.code&&(e.gatherList=r.data.data);case 5:case"end":return t.stop()}}),t)})))()},getTag:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,k["a"].getTag({all:!0});case 2:a=t.sent,r=a.data,0===r.code&&(e.tagList=r.data.data);case 5:case"end":return t.stop()}}),t)})))()},submit:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$refs.postForm.validate(function(){var a=Object(o["a"])(regeneratorRuntime.mark((function a(r){var n,o,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!r){a.next=22;break}if(e.content){a.next=4;break}return t.$message({message:"文章内容不能为空",type:"error",duration:2e3}),a.abrupt("return",!1);case 4:if(n=Object.assign({},t.postForm),n.articleContent=e,t.loading=!0,!t.id){a.next=13;break}return a.next=10,v["a"].editArticle(t.id,n);case 10:a.t0=a.sent,a.next=16;break;case 13:return a.next=15,v["a"].addArticle(n);case 15:a.t0=a.sent;case 16:o=a.t0,l=o.data,0===l.code?(t.$message({message:l.message,type:"success",duration:2e3}),t.$router.push("/article/list")):t.$message({message:l.message,type:"error",duration:2e3}),t.loading=!1,a.next=23;break;case 22:return a.abrupt("return",!1);case 23:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}());case 1:case"end":return a.stop()}}),a)})))()}}},$=_,q=(a("9ff6"),Object(d["a"])($,r,n,!1,null,"a0dd6562",null));t["default"]=q.exports},"8bc5":function(e,t,a){"use strict";var r=a("751a"),n=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r["a"].request({url:"/admin/categories",method:"post",data:e})},o=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r["a"].request({url:"/admin/categories/".concat(e),method:"put",data:t,config:a})},l=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r["a"].request({url:"/admin/categories",method:"get",params:e})},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r["a"].request({url:"/admin/categories/".concat(e),method:"delete",config:t})};t["a"]={getCategories:l,addCategories:n,editCategories:o,delCategories:i}},"90c8":function(e,t,a){},"9ff6":function(e,t,a){"use strict";var r=a("90c8"),n=a.n(r);n.a},a1fc:function(e,t,a){"use strict";var r=a("751a"),n=function(e){return r["a"].request({method:"get",url:"/admin/articles",params:e})},o=function(e){return r["a"].request({method:"delete",url:"/admin/articles/".concat(e)})},l=function(e){return r["a"].request({method:"post",url:"/admin/articles",data:e})},i=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r["a"].request({url:"/admin/articles/".concat(e),method:"put",data:t,config:a})},s=function(e){return r["a"].request({method:"get",url:"/admin/articles/find",params:e})},u=function(e){return r["a"].request({method:"get",url:"/admin/articles/fuzzySearch",params:e,headers:{"Content-Type":"multipart/form-data"}})},c=function(e){return r["a"].request({method:"post",url:"/admin/upload",data:e,headers:{"Content-Type":"multipart/form-data"}})};t["a"]={getArticle:n,delArticle:o,editArticle:i,findOneArticle:s,addArticle:l,uploadImg:c,fuzzySearch:u}},ad53:function(e,t,a){"use strict";var r=a("d73f"),n=a.n(r);n.a},aece:function(e,t,a){"use strict";var r=a("751a"),n=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r["a"].request({url:"/admin/tags",method:"post",data:e})},o=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r["a"].request({url:"/admin/tags/".concat(e),method:"put",data:t,config:a})},l=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r["a"].request({url:"/admin/tags",method:"get",params:e})},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r["a"].request({url:"/admin/tags/".concat(e),method:"delete",config:t})};t["a"]={getTag:l,addTag:n,editTag:o,delTag:i}},d73f:function(e,t,a){},f66f:function(e,t,a){"use strict";var r=a("751a"),n=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r["a"].request({url:"/admin/gather",method:"post",data:e})},o=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r["a"].request({url:"/admin/gather/".concat(e),method:"put",data:t,config:a})},l=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r["a"].request({url:"/admin/gather",method:"get",params:e})},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r["a"].request({url:"/admin/gather/".concat(e),method:"delete",config:t})};t["a"]={getGather:l,addGather:n,editGather:o,delGather:i}}}]);